!function(){"use strict";function t(t,e){void 0===e&&(e=""),e||(e="show");var n="show"===e?"block":"none";jQuery(t).css("display",n)}function e(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039"};return t.replace(/[&<>"']/g,(function(t){return e[t]}))}function n(){var t=acfw_edit_coupon.decimal_separator,e=jQuery(this),n=e.val()+"";n=="0"+t&&e.val("0"),"0"!=n&&n.substring(0,2)!="0"+t&&(n=(n=n.replace(/^0+/,"")).substring(0,1)==t?"0"+n:n,e.val(n))}function o(t,e,n,o){return void 0===n&&(n="value"),void 0===o&&(o="label"),t.map((function(t){return'<option value="'.concat(t[n],'" ').concat(t[n]==e?"selected":"",">").concat(t[o],"</option>")})).toString().replace(/>,</g,"><")}function a(t,e){return t==e?"selected":""}function c(t){void 0===t&&(t="");var e=acfw_edit_coupon.condition_field_options,n=e.exactly,o=e.anyexcept,c=e.morethan,i=e.lessthan;return'\n    <option value="=" '.concat(a(t,"="),">").concat(n,'</option>\n    <option value="!=" ').concat(a(t,"!="),">").concat(o,'</option>\n    <option value=">" ').concat(a(t,">"),">").concat(c,'</option>\n    <option value="<" ').concat(a(t,"<"),">").concat(i,"</option>\n  ")}function i(t){var e=acfw_edit_coupon.decimal_separator,n=parseFloat(t.replace(e,"."));return isNaN(n)?0:n}var l=jQuery,d=acfw_edit_coupon.cart_condition_fields.cart_weight;function r(t){var e=t.condition,n=t.value,o=d.title,a=d.desc,i=d.field,l=acfw_edit_coupon.condition_label;return'\n    <div class="cart-weight-field condition-field" data-type="cart-weight">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(o,"</h3>\n        <label>").concat(a,'</label>\n        <div class="field-control">\n            <label>').concat(l,'</label>\n            <select class="condition-select">\n                ').concat(c(e),'\n            </select>\n        </div>\n        <div class="field-control">\n            <label>').concat(i,'</label>\n            <input class="condition-value wc_input_decimal" type="text" value="').concat(n>=0?n:"",'">\n        </div>\n    </div>\n    ')}function s(t){return{condition:l(t).find(".condition-select").val(),value:l(t).find(".condition-value").val()}}function u(t){var n=t.product_id,o=t.product_label,a=t.condition_label,c=t.quantity;return'\n    <tr>\n        <td class="product" data-product="'.concat(e(JSON.stringify(t)),'" data-product_id="').concat(n,'">\n            ').concat(o,'\n        </td>\n        <td class="condition">').concat(a,'</td>\n        <td class="quantity">').concat(c,'</td>\n        <td class="actions">\n            <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n            <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n        </td>\n    </tr>\n    ')}function p(t){void 0===t&&(t=4);var e=acfw_edit_coupon.no_products_added;return'\n    <tr class="no-result">\n        <td colspan="'.concat(t,'">').concat(e,"</td>\n    </tr>\n    ")}var f=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},_=jQuery,v=acfw_edit_coupon.cart_condition_fields.product_quantity;function h(t){var e,n,o=acfw_edit_coupon.add_product_label,a=v.title,c=v.product_col,i=v.condition_col,l=v.quantity_col,d="",r=[];if(t.length)try{for(var s=f(t),_=s.next();!_.done;_=s.next()){var h=_.value;r.push(h.product_id),d+=u(h)}}catch(t){e={error:t}}finally{try{_&&!_.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}else d=p(4);return'\n    <div class="product-quantity-condition-field condition-set"  data-type="product-quantity">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(a,'</h3>\n        <table class="product-quantity-condition-table acfw-styled-table" data-exclude="').concat(JSON.stringify(r),'">\n            <thead>\n                <tr>\n                    <th class="product">').concat(c,'</th>\n                    <th class="condition">').concat(i,'</th>\n                    <th class="quantity">').concat(l,'</th>\n                    <th class="actions"></th>\n                </tr>\n            </thead>\n            <tbody>\n                ').concat(d,'\n            </tbody>\n            <tfoot>\n                <tr>\n                    <td colspan="4">\n                        <a class="add-table-row" href="javascript:void(0);">\n                            <i class="dashicons dashicons-plus"></i>\n                            ').concat(o,"\n                        </a>\n                    </td>\n                </tr>\n            </tfoot>\n        </table>\n    </div>\n    ")}function b(t){var e=t.querySelectorAll(".product-quantity-condition-table tr td.product"),n=[];return e.forEach((function(t){return n.push(_(t).data("product"))})),n}var y=jQuery,m=acfw_edit_coupon.cart_condition_fields.customer_registration_date;function g(t){var e=m.title,n=m.desc,o=m.hours;return'\n    <div class="customer-registration-date-field condition-field" data-type="customer-registration-date">\n\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(e,"</h3>\n\n        <label>").concat(n,'</label>   \n        <div class="field-control side-label">\n            <input class="condition-value" type="number" min="1" value="').concat(t&&t>-1?t:0,'">\n            <label>').concat(o,"</label>\n        </div>\n    </div>\n    ")}function w(t){return parseInt(y(t).find(".condition-value").val())}var x=jQuery,j=acfw_edit_coupon.cart_condition_fields.customer_last_ordered;function k(t){var e=j.title,n=j.desc,o=j.hours;return'\n    <div class="customer-last-ordered-field condition-field" data-type="customer-last-ordered">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(e,"</h3>\n        <label>").concat(n,'</label>    \n        <div class="field-control side-label">\n            <input class="condition-value" type="number" min="0" value="').concat(t&&t>-1?t:0,'">\n            <label>').concat(o,"</label>\n        </div>\n    </div>\n    ")}function S(t){return parseInt(x(t).find(".condition-value").val())}var q=jQuery,Q=acfw_edit_coupon.cart_condition_fields.total_customer_spend;function O(t){var e=t.condition,n=t.value,o=t.offset,a=acfw_edit_coupon.condition_label,l=Q.title,d=Q.desc,r=Q.total_spend,s=Q.days_offset,u=n?i(n):0;return'\n    <div class="total-customer-spend-field condition-field" data-type="total-customer-spend">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(l,"</h3>\n        <label>").concat(d,'</label>\n        <div class="field-control">\n            <label>').concat(a,'</label>\n            <select class="condition-select">\n                ').concat(c(e),'\n            </select>\n        </div>\n        <div class="field-control">\n            <label>').concat(r,'</label>\n            <input class="condition-value wc_input_price" type="text" min="0" value="').concat(!isNaN(u)&&u>-1?n:0,'">\n        </div>\n        <div class="field-control">\n            <label>').concat(s,'</label>\n            <input class="condition-offset" type="number" min="0" value="').concat(o&&o>-1?o:0,'">\n        </div>\n    </div>\n    ')}function z(t){return{condition:q(t).find(".condition-select").val(),value:q(t).find(".condition-value").val(),offset:q(t).find(".condition-offset").val()}}var $=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},N=function(){function t(){}return t.prototype.table_placeholder_row_template=function(t){void 0===t&&(t=4);var e=acfw_edit_coupon.no_products_added;return' \n            <tr class="no-result">\n                <td colspan="'.concat(t,'">').concat(e,"</td>\n            </tr>\n        ")},t.prototype.table_markup=function(){var t=acfw_edit_coupon.add_product_label,e=acfw_psaeic.tableproduct,n=e.products,o=n.label;return'\n            <table class="product-stock-availability-exists-in-cart-table acfw-styled-table">\n                <thead>\n                    <tr>\n                        <th class="product">'.concat(o.columns.product,'</th>\n                        <th class="condition">').concat(o.columns.condition,'</th>\n                        <th class="actions"></th>\n                    </tr>\n                </thead>\n                <tbody>\n                    ').concat(function(){var t,o,a="";if(n&&n.data&&n.data.length)try{for(var c=$(n.data),i=c.next();!i.done;i=c.next()){var l=i.value;e.row.data=l,a+=e.row.template_view_row()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=c.return)&&o.call(c)}finally{if(t)throw t.error}}else a=e.template.table_placeholder_row_template(4);return a}(),'\n                </tbody>\n                <tfoot>\n                    <tr>\n                        <td colspan="4">\n                            <a class="psaeic-btn-add-category-row" href="javascript:void(0);" onclick="acfw_psaeic.tableproduct.trigger.trigger_btn_add_category(event)">\n                                <i class="dashicons dashicons-plus"></i>\n                                ').concat(t,"\n                            </a>\n                        </td>\n                    </tr>\n                </tfoot>\n            </table>\n        ")},t}(),C=jQuery,I=function(){function t(){}return t.prototype.trigger_btn_add_category=function(t){var e=acfw_psaeic.tableproduct,n=t.currentTarget;e.row.element.$button=C(n),e.row.data=e.row.data_initial(),e.row.add()},t.prototype.trigger_btn_action_add=function(t){var e=acfw_psaeic.tableproduct,n=t.currentTarget;e.row.element.$button=C(n),e.row.view()},t.prototype.trigger_btn_action_edit=function(t){var e=acfw_psaeic.tableproduct,n=t.currentTarget;e.row.element.$button=C(n),e.row.edit()},t.prototype.trigger_btn_action_cancel=function(t){var e=acfw_psaeic.tableproduct,n=t.currentTarget;e.row.element.$button=C(n),e.row.cancel()},t.prototype.trigger_btn_action_remove=function(t){var e=acfw_psaeic.tableproduct,n=t.currentTarget;e.row.element.$button=C(n),e.row.detect(),e.row.remove()},t}(),A=jQuery,J=function(){function t(){this._element={$button:A(null),$table:A(this),$tbody:A(this),$row:A(this),$product:A(this),$condition:A(this),colspan:4,data:[]},this._data=this.data_initial()}return Object.defineProperty(t.prototype,"element",{get:function(){return this._element},set:function(t){this._element=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!1,configurable:!0}),t.prototype.data_initial=function(){return{product:{id:0,label:""},condition:{id:"",label:""}}},t.prototype.template_initiate_select2=function(){this._element.$tbody.find("select.wc-product-search").trigger("change"),A("body").trigger("wc-enhanced-select-init")},t.prototype.template_add_edit_row=function(){var t=this,n=acfw_psaeic.tableproduct.products,o=acfw_edit_coupon.product_table_buttons,a=o.edit,c=o.add,i=o.cancel,l=acfw_edit_coupon.bogo_form_fields.type_to_search;return'\n            <tr class="add-edit-form adding">\n                <td class="product" data-product="'.concat("object"==typeof this._data?e(JSON.stringify(this._data)):0,'">\n                    <div class="object-search-wrap">\n                        <select class="psaeic-select-product wc-product-search" data-placeholder="').concat(l,'" data-action="acfwp_add_products_search">\n                            ').concat("object"==typeof this._data&&this._data.product.id?'<option value="'.concat(this._data.product.id,'" selected>').concat(this._data.product.label,"</option>"):"",'\n                        </select>                        \n                    </div>\n                </td>\n                <td class="condition">                \n                    <select class="condition-select psaeic-select-condition">\n                        ').concat(Object.keys(n.options.conditions).map((function(e){var o=n.options.conditions[e],a="object"==typeof t._data&&t._data.condition.id==e?"selected":"";return'<option value="'.concat(e,'" ').concat(a,">").concat(o,"</option>")})).join(""),'\n                    </select> \n                </td>\n                <td class="actions">\n                    <button type="button" class="button-primary psaeic-btn-add" onclick="acfw_psaeic.tableproduct.trigger.trigger_btn_action_add(event)">').concat("object"==typeof this._data&&this._data.product.id?a:c,'</button>\n                    <button type="button" class="button psaeic-btn-cancel" onclick="acfw_psaeic.tableproduct.trigger.trigger_btn_action_cancel(event)">').concat(i,"</button>\n                </td>\n            </tr>\n        ")},t.prototype.template_view_row=function(){return'\n            <tr>\n                <td class="product product-'.concat(this._data.product.id,' object" data-product="').concat(e(JSON.stringify(this._data)),'">\n                    ').concat(this._data.product.label,'\n                </td>\n                <td class="condition">').concat(this._data.condition.label,'</td>\n                <td class="actions">\n                    <a class="psaeic-btn-edit" href="javascript:void(0)" onclick="acfw_psaeic.tableproduct.trigger.trigger_btn_action_edit(event)"><span class="dashicons dashicons-edit"></span></a>\n                    <a class="psaeic-btn-remove" href="javascript:void(0)" onclick="acfw_psaeic.tableproduct.trigger.trigger_btn_action_remove(event)"><span class="dashicons dashicons-no"></span></a>\n                </td>\n            </tr>\n        ')},t.prototype.detect=function(){this._element.$button&&(this._element.$row=this._element.$button.closest("tr"),this._element.$table=this._element.$button.closest(".acfw-styled-table"),this._element.$tbody=this._element.$table.find("tbody"),this._element.$product=this._element.$row.find(".psaeic-select-product"),this._element.$condition=this._element.$row.find(".psaeic-select-condition"),this._element.colspan=this._element.$row.find("td").length,this._element.data=this._element.$row.find("td.product").data("product"))},t.prototype.read=function(){var t,e,n,o,a,c,i,l=this._element,d=l.$product,r=l.$condition;this._data={product:{id:parseInt(null!==(e=null===(t=null==d?void 0:d.val())||void 0===t?void 0:t.toString())&&void 0!==e?e:""),label:null!==(a=null===(o=null===(n=A(d))||void 0===n?void 0:n.select2("data")[0])||void 0===o?void 0:o.text.replace("\n","").replace(/\s+/g," ").trim())&&void 0!==a?a:""},condition:{id:null!==(i=null===(c=null==r?void 0:r.val())||void 0===c?void 0:c.toString())&&void 0!==i?i:"",label:r.find("option:selected").text().replace("\n","").replace(/\s+/g," ").trim()}}},t.prototype.validate=function(t){void 0===t&&(t=!0);var e=acfw_psaeic.tableproduct,n=acfw_edit_coupon.fill_form_propery_error_msg,o=this._element,a=o.$product,c=o.$condition,i=this._data.product;return a.val()&&c.val()?(this._element.$table.find("td.product.object").each((function(){if(A(this).data("product").product.id==i.id)return vex.dialog.alert(e.products.exists),!1})),t):(vex.dialog.alert(n),!1)},t.prototype.add=function(){this.detect(),this._data.product.id&&!this.validate()||(this._element.$tbody.find("tr.no-result").remove(),this._element.$tbody.append(this.template_add_edit_row()),this.template_initiate_select2())},t.prototype.edit=function(){this.detect(),this._data=this._element.data,this._element.$row.replaceWith(this.template_add_edit_row()),this.template_initiate_select2()},t.prototype.view=function(t){void 0===t&&(t={}),this.template_initiate_select2(),this.detect(),Object.keys(t).length||this.read(),this.validate()&&this._element.$row.replaceWith(this.template_view_row())},t.prototype.cancel=function(){this.detect(),this.remove()},t.prototype.remove=function(){var t=acfw_psaeic.tableproduct;this._element.$row.remove(),this._element.$tbody.find("tr").length<=0&&this._element.$tbody.html(t.template.table_placeholder_row_template(this._element.colspan))},t}(),P=J,E=function(){return E=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},E.apply(this,arguments)},T=function(){function t(){this._products={},this._trigger={},this._template={},this._row={}}return Object.defineProperty(t.prototype,"products",{get:function(){return this._products},set:function(t){this._products=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"template",{get:function(){return this._template},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trigger",{get:function(){return this._trigger},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),t.prototype.build=function(){this._row=new P,this._template=new N,this._trigger=new I,this.save()},t.prototype.save=function(){window.acfw_psaeic=E(E({},acfw_edit_coupon.cart_condition_fields.acfw_product_stock_availability_exists_in_cart),{tableproduct:this})},t}(),D=jQuery,W=acfw_edit_coupon.cart_condition_fields.product_stock_availability_exists_in_cart;function M(t){void 0===t&&(t={});var e=W.title,n=W.products;n.data=t.products;var o=new T;return o.products=n,o.build(),'\n        <div class="product-stock-availability-exists-in-cart-field condition-set" data-type="product-stock-availability-exists-in-cart">\n            <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n            <h3 class="condition-field-title">'.concat(e,"</h3>\n            \n            ").concat(o.template.table_markup(),"\n        </div>\n    ")}function F(t){var e=t.querySelectorAll(".product-stock-availability-exists-in-cart-table tr td.product"),n=[];return e.forEach((function(t){return n.push(D(t).data("product"))})),{products:n}}var H=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},V=jQuery,K=acfw_edit_coupon.cart_condition_fields.has_ordered_before;function R(t){var e,n;void 0===t&&(t={});var o=t.condition,c=t.value,i=t.products,l=acfw_edit_coupon.cart_condition_fields,d=acfw_edit_coupon.add_product_label,r=l.product_quantity,s=r.product_col,f=r.condition_col,_=r.quantity_col,v=l.has_ordered_before,h=v.title,b=v.type,y=v.within_a_period,m=v.number_of_orders,g=v.num_prev_days,w=[],x="";if(i&&i.length)try{for(var j=H(i),k=j.next();!k.done;k=j.next()){var S=k.value;w.push(S.product_id),x+=u(S)}}catch(t){e={error:t}}finally{try{k&&!k.done&&(n=j.return)&&n.call(j)}finally{if(e)throw e.error}}else x=p(4);return'\n    <div class="cart-quantity-field condition-field condition-set" data-type="has-ordered-before">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(h,'</h3>\n        <div class="field-control">\n            <label>').concat(b,'</label>\n            <select class="condition-select has-ordered-before-type">\n                <option value="within-a-period" ').concat(a(o,"within-a-period"),">").concat(y,'</option>\n                <option value="number-of-orders" ').concat(a(o,"number-of-orders"),">").concat(m,'</option>\n            </select>\n        </div>\n        <div class="field-control condition-type-value">\n            <label>').concat(g,'</label>\n            <input class="condition-value" type="number" min="0" value="').concat(c,'">\n        </div>\n        <table class="has-ordered-before-products-table acfw-styled-table" data-exclude="').concat(JSON.stringify(w),'">\n            <thead>\n                <tr>\n                    <th class="product">').concat(s,'</th>\n                    <th class="condition">').concat(f,'</th>\n                    <th class="quantity">').concat(_,'</th>\n                    <th class="actions"></th>\n                </tr>\n            </thead>\n            <tbody>\n                ').concat(x,'\n            </tbody>\n            <tfoot>\n                <tr>\n                    <td colspan="4">\n                        <a class="add-table-row" href="javascript:void(0);">\n                            <i class="dashicons dashicons-plus"></i>\n                            ').concat(d,"\n                        </a>\n                    </td>\n                </tr>\n            </tfoot>\n        </table>\n    </div>\n    ")}function X(t){var e=t.querySelectorAll(".has-ordered-before-products-table tr td.product"),n=[];return e.forEach((function(t){return n.push(V(t).data("product"))})),{condition:V(t).find(".condition-select").val(),value:parseInt(V(t).find(".condition-value").val()),products:n}}var B=jQuery,G=acfw_edit_coupon.cart_condition_fields.has_ordered_product_categories_before;function L(t){void 0===t&&(t={});var e=t.condition,n=t.quantity,o=acfw_edit_coupon.condition_label,c=acfw_edit_coupon.cart_condition_fields,i=c.cart_quantity.field,l=c.has_ordered_product_categories_before,d=l.title,r=l.type,s=l.within_a_period,u=l.number_of_orders,p=l.num_prev_days,f=l.categories,_=c.product_category.placeholder,v=acfw_edit_coupon.condition_field_options,h=[{value:"within-a-period",label:s},{value:"number-of-orders",label:u}],b=[{value:"=",label:v.exactly},{value:"!=",label:v.anyexcept},{value:">",label:v.morethan},{value:"<",label:v.lessthan}];return'\n        <div class="has-ordered-product-categories-before-field condition-field condition-set" data-type="has-ordered-product-categories-before">\n            <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n            <h3 class="condition-field-title">'.concat(d,'</h3>\n            \n            <div class="field-control">\n                <label>').concat(r,'</label>\n                <select class="hopcb-select-type-condition">                    \n                    ').concat(h.map((function(t){var n=t.value,o=t.label;return'<option value="'.concat(n,'" ').concat(a(e,n),">").concat(o,"</option>")})).join(""),'\n                </select>\n            </div>\n            <div class="field-control">\n                <label>').concat(p,'</label>\n                <input class="hopcb-select-type-value" type="number" min="0" value="').concat(t.type&&t.type.value?t.type.value:0,'">\n            </div>\n            <div class="field-control categories">\n                <label></label>\n                <select class="hopcb-select-categories wc-enhanced-select" multiple data-placeholder="').concat(_,'">\n                    ').concat(Object.keys(f.options).map((function(e){var n=f.options[e],o=t.categories&&t.categories.indexOf(parseInt(e))>=0?"selected":"";return'<option value="'.concat(e,'" ').concat(o,">").concat(n,"</option>")})).join(""),'\n                </select>\n            </div>\n            <div class="field-control">\n                <label>').concat(o,'</label>\n                <select class="hopcb-select-condition">\n                    ').concat(b.map((function(e){var n=e.value,o=e.label,a=(t.condition?t.condition:">")===n?"selected":"";return'<option value="'.concat(n,'" ').concat(a,">").concat(o,"</option>")})).join(""),'\n                </select>\n            </div>\n            <div class="field-control">\n                <label>').concat(i,'</label>\n                <input type="number" class="hopcb-select-quantity" value="').concat(n,'" min="').concat("<"==e?1:0,'">\n            </div>\n            \n        </div>\n    ')}function U(t){if(null==t)return!1;if("string"==typeof t&&""===t.trim())return!1;if(Array.isArray(t)&&0===t.length)return!1;if("object"==typeof t)for(var e in t)if(!U(t[e]))return!1;return!0}function Y(t){t.querySelectorAll(".has-ordered-product-categories-before-table tr td.category");var e={categories:B(t).find(".hopcb-select-categories").val(),condition:B(t).find(".hopcb-select-condition").val(),quantity:B(t).find(".hopcb-select-quantity").val(),type:{condition:B(t).find(".hopcb-select-type-condition").val(),label:B(t).find(".hopcb-select-type-condition option:selected").text(),value:B(t).find(".hopcb-select-type-value").val()}};return!!U(e)&&e}var Z=jQuery,tt=acfw_edit_coupon.cart_condition_fields.total_customer_spend_on_product_category;function et(t){void 0===t&&(t={});var e=t.condition,n=t.spend,o=acfw_edit_coupon.condition_label,c=acfw_edit_coupon.cart_condition_fields,i=c.total_customer_spend.total_spend,l=c.total_customer_spend_on_product_category,d=l.title,r=l.type,s=l.within_a_period,u=l.number_of_orders,p=l.num_prev_days,f=l.categories,_=c.product_category.placeholder,v=acfw_edit_coupon.condition_field_options,h=[{value:"within-a-period",label:s},{value:"number-of-orders",label:u}],b=[{value:"=",label:v.exactly},{value:"!=",label:v.anyexcept},{value:">",label:v.morethan},{value:"<",label:v.lessthan}];return'\n        <div class="total-customer-spend-on-product-category-field condition-field condition-set" data-type="total-customer-spend-on-product-category">\n            <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n            <h3 class="condition-field-title">'.concat(d,'</h3>\n            \n            <div class="field-control">\n                <label>').concat(r,'</label>\n                <select class="tcspc-select-type-condition">                    \n                    ').concat(h.map((function(t){var n=t.value,o=t.label;return'<option value="'.concat(n,'" ').concat(a(e,n),">").concat(o,"</option>")})).join(""),'\n                </select>\n            </div>\n            <div class="field-control">\n                <label>').concat(p,'</label>\n                <input class="tcspc-select-type-value" type="number" min="0" value="').concat(t.type&&t.type.value?t.type.value:0,'">\n            </div>\n            <div class="field-control categories">\n                <label></label>\n                <select class="tcspc-select-categories wc-enhanced-select" multiple data-placeholder="').concat(_,'">\n                    ').concat(Object.keys(f.options).map((function(e){var n=f.options[e],o=t.categories&&t.categories.indexOf(parseInt(e))>=0?"selected":"";return'<option value="'.concat(e,'" ').concat(o,">").concat(n,"</option>")})).join(""),'\n                </select>\n            </div>\n            <div class="field-control">\n                <label>').concat(o,'</label>\n                <select class="tcspc-select-condition">\n                    ').concat(b.map((function(e){var n=e.value,o=e.label,a=(t.condition?t.condition:">")===n?"selected":"";return'<option value="'.concat(n,'" ').concat(a,">").concat(o,"</option>")})).join(""),'\n                </select>\n            </div>\n            <div class="field-control">\n                <label>').concat(i,'</label>\n                <input type="text" class="tcspc-select-spend wc_input_decimal" value="').concat(null!=n?n:0,'">\n            </div>\n            \n        </div>\n    ')}function nt(t){if(null==t)return!1;if("string"==typeof t&&""===t.trim())return!1;if(Array.isArray(t)&&0===t.length)return!1;if("object"==typeof t)for(var e in t)if(!nt(t[e]))return!1;return!0}function ot(t){var e={categories:Z(t).find(".tcspc-select-categories").val(),condition:Z(t).find(".tcspc-select-condition").val(),spend:Z(t).find(".tcspc-select-spend").val(),type:{condition:Z(t).find(".tcspc-select-type-condition").val(),label:Z(t).find(".tcspc-select-type-condition option:selected").text(),value:Z(t).find(".tcspc-select-type-value").val()}};return!!nt(e)&&e}var at=jQuery,ct=acfw_edit_coupon.cart_condition_fields.shipping_zone_region;function it(t){var n=t.value,o=ct.title,c=ct.zone_label,i=ct.zone_placeholder,l=ct.regions_label,d=ct.regions_placeholder,r=ct.zone_options,s=n&&n.length?n:[];return'\n    <div class="shipping-zone-region-field condition-field" data-type="shipping-zone-region"\n        data-zones="'.concat(e(JSON.stringify(r)),'"\n        data-regions="').concat(e(JSON.stringify(s)),'">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">').concat(o,'</h3>\n        <div class="field-control">\n            <label>').concat(c,'</label>\n            <select class="condition-select wc-enhanced-select" data-placeholder="').concat(e(i),'">\n                <option value="">').concat(i,"</option>\n                ").concat(function(t,e){var n=t.condition,o="";for(var c in e){var i=e[c];o+='\n            <option value="'.concat(c,'" ').concat(a(n,c),">\n                ").concat(i.name,"\n            </option>\n        ")}return o}(t,r),'\n            </select>\n        </div>\n        <div class="field-control regions">\n            <label>').concat(l,'</label>\n            <select class="condition-value wc-enhanced-select" multiple data-placeholder="').concat(e(d),'">\n            </select>\n        </div>\n    </div>\n    ')}function lt(t){return{condition:at(t).find(".condition-select").val(),value:at(t).find(".condition-value").val()}}var dt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},rt=jQuery,st=acfw_edit_coupon.cart_condition_fields.custom_taxonomy,ut=acfw_edit_coupon.cart_condition_fields,pt=acfw_edit_coupon.condition_field_options;function ft(t){var n=t.condition,o=t.value,c=t.qtyCondition,i=t.quantity,l=st.title,d=st.select_taxonomy,r=(st.product_type,st.select_terms),s=ut.cart_quantity.field,u=acfw_edit_coupon.condition_label,p=pt.exactly,f=pt.anyexcept,_=pt.morethan,v=pt.lessthan,h=c||">",b=o&&o.length?o:[];return'\n    <div class="custom-taxonomy-field condition-field" data-type="custom-taxonomy" \n      data-selected_terms="'.concat(e(JSON.stringify(b)),'">\n      <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n      <h3 class="condition-field-title">').concat(l,'</h3>\n      <div class="field-control">\n        <select class="condition-select wc-enhanced-select custom-taxonomy" data-placeholder="').concat(d,'">\n          <option value="">').concat(d,"</option>\n          ").concat(function(t){var e,n,o=st.tax_options,c=(st.product_type,"");try{for(var i=dt(o),l=i.next();!l.done;l=i.next()){var d=l.value,r=d.name,s=d.label;c+='\n      <option value="'.concat(r,'" ').concat(a(t,r),">\n        ").concat(s,"\n      </option>\n    ")}}catch(t){e={error:t}}finally{try{l&&!l.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return c}(n),'\n        </select>\n      </div>\n      <div class="field-control field-control-wide">\n        <select class="condition-value wc-enhanced-select" multiple data-placeholder="').concat(r,'">\n        </select>\n      </div>\n      <div class="field-control condition">\n            <label>').concat(u,'</label>\n            <select class="condition-select qty-condition-select">\n                <option value="=" ').concat("="==h?"selected":"",">").concat(p,'</option>\n                <option value="!=" ').concat("!="==h?"selected":"",">").concat(f,'</option>\n                <option value=">" ').concat(">"==h?"selected":"",">").concat(_,'</option>\n                <option value="<" ').concat("<"==h?"selected":"",">").concat(v,'</option>\n            </select>\n        </div>\n        <div class="field-control quantity">\n            <label>').concat(s,'</label>\n            <input type="number" class="condition-quantity" value="').concat("number"==typeof i?i:0,'" min="').concat("<"==c?1:0,'">\n        </div>\n    </div>\n    ')}function _t(t){return{condition:rt(t).find(".condition-select").val(),value:rt(t).find(".condition-value").val(),qtyCondition:rt(t).find(".qty-condition-select").val(),quantity:rt(t).find(".condition-quantity").val()}}var vt=jQuery,ht=acfw_edit_coupon.cart_condition_fields,bt=ht.custom_user_meta,yt=ht.custom_cart_item_meta;function mt(t,e){var n=t.condition,o=t.key,i=t.value,l=t.type,d=acfw_edit_coupon.condition_label,r=ht[e],s=r.title,u=r.meta_key,p=r.meta_value,f=r.value_type,_=e.replace(/_/g,"-");return'\n    <div class="'.concat(_,'-field condition-field" data-type="').concat(_,'">\n      <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n      <h3 class="condition-field-title">').concat(s,'</h3>\n      <div class="field-control wider">\n        <label>').concat(f,'</label>\n        <select class="value-type">\n          ').concat(function(t,e){var n=ht[e].type_options,o="";for(var c in n){var i=n[c];o+='<option value="'.concat(c,'" ').concat(a(t,c),">").concat(i,"</option>")}return o}(l,e),'\n        </select>\n      </div>\n      <div class="field-control">\n        <label>').concat(d,'</label>\n        <select class="condition-select">\n          ').concat(c(n),"\n          ").concat("custom_cart_item_meta"===e?function(t){void 0===t&&(t="");var e=acfw_edit_coupon.condition_exists_field_option,n=e.exists,o=e.notexist;return'\n    <option value="exists" '.concat(a(t,"exists"),">").concat(n,'</option>\n    <option value="notexist" ').concat(a(t,"notexist"),">").concat(o,"</option>\n  ")}(n):"",'\n        </select>\n      </div>\n      <div class="field-control wider">\n        <label>').concat(u,'</label>\n        <input class="condition-key" type="text" value="').concat(o||"",'">\n      </div>\n      <div class="field-control wider">\n        <label>').concat(p,'</label>\n        <input class="condition-value" type="text" value="').concat(i||i>-1?i:"",'">\n      </div>\n    </div>\n  ')}function gt(t){return{condition:vt(t).find(".condition-select").val(),key:vt(t).find(".condition-key").val(),value:vt(t).find(".condition-value").val(),type:vt(t).find(".value-type").val()}}var wt=jQuery,xt=acfw_edit_coupon.cart_condition_fields.number_of_orders;function jt(t){var e=t.condition,n=t.value,o=t.offset,a=acfw_edit_coupon.condition_label,i=xt.title,l=xt.desc,d=xt.count_label,r=xt.prev_days_label;return'\n    <div class="number-of-orders-field cart-quantity-field condition-field" data-type="number-of-orders">\n      <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n      <h3 class="condition-field-title">'.concat(i,"</h3>\n      <label>").concat(l,'</label>\n      <div class="field-control">\n        <label>').concat(a,'</label>\n        <select class="condition-select">\n            ').concat(c(e),'\n        </select>\n      </div>\n      <div class="field-control">\n          <label>').concat(d,'</label>\n          <input class="condition-value" type="number" min="0" value="').concat(n>=0?n:"",'">\n      </div>\n      <div class="field-control">\n          <label>').concat(r,'</label>\n          <input class="condition-offset" type="number" min="0" value="').concat(o>=0?o:"",'">\n      </div>\n    </div>\n  ')}function kt(t){return{condition:wt(t).find(".condition-select").val(),value:wt(t).find(".condition-value").val(),offset:wt(t).find(".condition-offset").val()}}var St=jQuery;function qt(){var t=document.querySelector("#acfw_cart_conditions");v.default_data_value={},v.template_callback=h,v.scraper_callback=b,d.default_data_value={},d.template_callback=r,d.scraper_callback=s,m.template_callback=g,m.scraper_callback=w,j.template_callback=k,j.scraper_callback=S,Q.default_data_value={},Q.template_callback=O,Q.scraper_callback=z,W.default_data_value={},W.template_callback=M,W.scraper_callback=F,K.default_data_value={},K.template_callback=R,K.scraper_callback=X,G.default_data_value={},G.template_callback=L,G.scraper_callback=Y,tt.default_data_value={},tt.template_callback=et,tt.scraper_callback=ot,ct.default_data_value={},ct.template_callback=it,ct.scraper_callback=lt,st.default_data_value={},st.template_callback=ft,st.scraper_callback=_t,bt.default_data_value={},bt.template_callback=mt,bt.scraper_callback=gt,yt.default_data_value={},yt.template_callback=mt,yt.scraper_callback=gt,xt.default_data_value={},xt.template_callback=jt,xt.scraper_callback=kt,St(t).on("change","input.condition-value",Qt),St(t).on("change",".custom-cart-item-meta-field .condition-select",Ot)}function Qt(){var t=St(this);if("number"===t.closest(".condition-field").find("select.value-type").val()){var e=parseInt(t.val()+"");t.val(isNaN(e)?"":Math.round(e))}}function Ot(){var t,e=St(this),n=e.closest(".condition-field").find(".condition-value");["exists","notexist"].includes(e.val().toString())?(n.val(0),n.prop("disabled",!0),n.parent().hide()):["exists","notexist"].includes(null===(t=e.data("prevValue"))||void 0===t?void 0:t.toString())&&(n.val(""),n.prop("disabled",!1),n.parent().show()),e.data("prevValue",e.val().toString())}var zt=jQuery,$t=document.querySelector("#acfw_add_products");function Nt(t){zt($t).data("editing",t),zt($t).find("#save-add-products").prop("disabled",!t)}function Ct(t,n){void 0===t&&(t=[]),void 0===n&&(n=!1);var o=n.discount_type,c=n.discount_value,l=acfw_edit_coupon.product_table_buttons,d=l.edit,r=l.add,s=l.cancel,u=acfw_edit_coupon.bogo_form_fields.type_to_search,p="object"==typeof n?function(t){var e=t.product_id,n=t.product_label;return'<option value="'.concat(e,'">').concat(n,"</option>")}(n):"",f="object"==typeof n?d:r,_=c&&i(c)>=0&&"nodiscount"!==o?c:"";return'\n    <tr class="add-edit-form adding">\n        <td class="product" data-object="'.concat("object"==typeof n?e(JSON.stringify(n)):0,'">\n            <div class="object-search-wrap">\n                <select class="').concat("product-in-cart",' wc-product-search"\n                    data-placeholder="').concat(u,'"\n                    data-action="').concat("acfwp_add_products_search",'"\n                    data-exclude="').concat(e(JSON.stringify(t)),'">').concat(p,'</select>\n            </div>\n        </td>\n        <td class="quantity">\n            <input type="number" class="condition-quantity" value="').concat("object"==typeof n?n.quantity:1,'" min="1">\n        </td>\n        <td class="price">\n            <div>\n            <select class="discount_type">\n                ').concat(function(t,e){void 0===t&&(t=""),void 0===e&&(e=!1);var n=acfw_edit_coupon.currency_symbol,o=acfw_edit_coupon.discount_field_options,c=o.nodiscount,i=o.override,l=o.percent,d=o.fixed,r='<option value="nodiscount" '.concat(a(t,"nodiscount"),">= : ").concat(c,"</option>");return"\n    ".concat(e?r:"",'\n    <option value="override" ').concat(a(t,"override"),">").concat(n," : ").concat(i,'</option>\n    <option value="percent" ').concat(a(t,"percent"),">% : ").concat(l,'</option>\n    <option value="fixed" ').concat(a(t,"fixed"),">-").concat(n," : ").concat(d,"</option>\n  ")}(o,!0),'\n            </select>\n            <input type="text" class="discount_value short wc_input_price" value="').concat(_,'">\n            </div>\n        </td>\n        <td class="actions">\n            <button type="button" class="condition-product-add button-primary">').concat(f,'</button>\n            <button type="button" class="cancel button">').concat(s,"</button>\n        </td>\n    </tr>\n    ")}function It(t){var n=t.product_id,o=t.product_label,a=t.quantity,c=t.discount_type,i=t.discount_value,l="nodiscount"!==c?i:"";return'\n    <tr>\n        <td class="product product-'.concat(n,' object" data-product="').concat(e(JSON.stringify(t)),'">\n            ').concat(o,'\n        </td>\n        <td class="quantity">').concat(a,'</td>\n        <td class="price">(').concat(c,") ").concat(l,'</td>\n        <td class="actions">\n            <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n            <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n        </td>\n    </tr>\n    ')}function At(t){void 0===t&&(t=4);var e=acfw_edit_coupon.no_products_added;return'\n    <tr class="no-result">\n        <td colspan="'.concat(t,'">').concat(e,"</td>\n    </tr>\n    ")}var Jt=jQuery;function Pt(){var t=Jt(this).closest(".acfw-styled-table"),e=t.find("tbody"),n=t.data("exclude");e.find("tr.no-result").remove(),e.append(Ct(n)),e.find("select.discount_type").trigger("change"),e.find("select.wc-product-search").trigger("change"),Jt("body").trigger("wc-enhanced-select-init")}function Et(){var t=jQuery(this),e=t.closest("tr"),n=t.closest(".acfw-styled-table"),o=n.find("tbody"),a=e.find(".product").data("product"),c=a.product_id,i=n.data("exclude");(i="object"==typeof i?i:[]).splice(i.indexOf(c),1),o.find("tr.no-result").remove(),e.replaceWith(Ct(i,a)),o.find("select.discount_type").trigger("change"),o.find("select.wc-product-search").trigger("acfw_product_select"),n.data("exclude",i),n.find("select.wc-product-search").data("exclude",i),Jt("body").trigger("wc-enhanced-select-init")}function Tt(){var t=acfw_edit_coupon.fill_form_propery_error_msg,e=(acfw_edit_coupon.product_exists_in_table,jQuery(this)),n=e.closest("tr"),o=e.closest("table.acfw-styled-table"),a=n.find(".wc-product-search"),c=n.find(".condition-quantity"),l=n.find("select.discount_type").val().toString(),d=n.find("input.discount_value").val().toString(),r=o.data("exclude"),s=parseInt(n.find(".wc-product-search").val().toString()),u={product_id:s,quantity:parseInt(n.find(".condition-quantity").val().toString()),product_label:n.find(".wc-product-search option:selected").text(),discount_type:l,discount_value:d};!a.val()||!c.val()||c.val()<1||"nodiscount"!==l&&(isNaN(i(d))||i(d)<0)?vex.dialog.alert(t):r.includes(s)?vex.dialog.alert(acfw_edit_coupon.product_exists_in_table):((r="object"==typeof r?r:[]).push(s),n.replaceWith(It(u)),o.data("exclude",r),o.find(".wc-product-search").data("exclude",r),Nt(!0))}function Dt(){var t=jQuery(this),e=t.closest("tr"),n=t.closest("table"),o=e.closest("tbody"),a=e.find("td").length,c=e.find("td.product").data("object"),i=n.data("exclude");i.includes(c.product_id)?vex.dialog.alert(acfw_edit_coupon.product_exists_in_table):"object"==typeof c?((i="object"==typeof i?i:[]).push(c.product_id),e.replaceWith(It(c)),n.data("exclude",i),n.find(".wc-product-search").data("exclude",i)):(e.remove(),o.find("tr").length<=0&&o.html(At(a)))}function Wt(){var t=jQuery(this).closest("tr"),e=t.closest("table"),n=t.closest("tbody"),o=t.find("td").length,a=t.find("td.object").data("product"),c=e.data("exclude"),i=c.indexOf(parseInt(a.product_id));-1!==i&&c.splice(i,1),e.data("exclude",c),e.find(".wc-product-search").data("exclude",c),t.remove(),n.find("tr").length<=0&&n.html(At(o)),Nt(!0)}var Mt=jQuery,Ft=woocommerce_admin_meta_boxes.post_id,Ht=document.querySelector("#acfw_add_products"),Vt=Ht?Ht.querySelector(".acfw-overlay"):null;function Kt(){Mt("#acfw_bogo_deals").find(".acfw-styled-table tr.add-edit-form button.cancel").trigger("click");var e,n=acfw_edit_coupon.post_status,o=Ht.querySelectorAll("table.acfw-styled-table tbody td.object"),a=Ht.querySelector(".add-before-cart-condition-check-field input[type='checkbox']"),c=[];o.forEach((function(t){(e=Mt(t).data("product"))&&c.push(e)})),t(Vt,"show"),Mt.post(ajaxurl,{action:"acfw_save_add_products_data",coupon_id:Ft,products:c.length?c:"empty",add_before_conditions:Mt(a).is(":checked")?1:0,nonce:Mt("#acfw_add_products").data("nonce")},(function(e){"success"==e.status?"publish"!==n&&(Mt("input[name='post_title']").val()||Mt("input[name='post_title']").val("coupon-"+Ft),Mt("select[name='post_status']").append(new Option("Published","publish")).val("publish"),Mt("#publishing-action").append('\n                    <input type="hidden" name="publish" value="Publish">\n                '),Mt("input#publish").click()):e.error_msg&&(vex.dialog.alert(e.error_msg),console.log(e),Mt(Ht).addClass("save-error")),Mt(Ht).find("button#clear-add-products").prop("disabled",!1),Nt(!1),t(Vt,"hide")}),"json")}function Rt(){var e=Mt(this);if(confirm(e.data("prompt"))){var n=Ht.querySelector("table.acfw-styled-table tbody");t(Vt,"show"),Mt.post(ajaxurl,{action:"acfw_clear_add_products_data",coupon_id:Ft,_wpnonce:e.data("nonce")},(function(o){"success"==o.status?(Mt(n).html(At(4)),e.prop("disabled",!0),Nt(!1),"Published"!=Mt("#post-status-display").text()&&(Mt("input[name='post_title']").val()||Mt("input[name='post_title']").val("coupon-"+Ft),Mt("input#publish").click())):(o.error_msg&&vex.dialog.alert(o.error_msg),console.log(o)),t(Vt,"hide")}),"json")}}function Xt(t){Mt(".coupon_data_tabs").find(".acfw_add_products_tab").hasClass("active")&&Mt(Ht).data("editing")&&(t.preventDefault(),Mt(Ht).find("#save-add-products").trigger("click"),setTimeout((function(){Mt(Ht).hasClass("save-error")?Mt(Ht).removeClass("save-error"):Mt("form#post").submit()}),1e3))}var Bt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,a,c=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(o=c.next()).done;)i.push(o.value)}catch(t){a={error:t}}finally{try{o&&!o.done&&(n=c.return)&&n.call(c)}finally{if(a)throw a.error}}return i},Gt=function(t,e,n){if(n||2===arguments.length)for(var o,a=0,c=e.length;a<c;a++)!o&&a in e||(o||(o=Array.prototype.slice.call(e,0,a)),o[a]=e[a]);return t.concat(o||Array.prototype.slice.call(e))},Lt=jQuery,Ut=document.querySelector("#acfw_add_products");function Yt(t){void 0===t&&(t=jQuery),t(Ut).on("click",".acfw-styled-table tfoot .add-table-row",Pt),t(Ut).on("click",".acfw-styled-table td.actions a.edit",Et),t(Ut).on("click","tr.add-edit-form .actions .condition-product-add",Tt),t(Ut).on("click","tr.add-edit-form .actions .cancel",Dt),t(Ut).on("click",".acfw-styled-table td.actions a.remove",Wt),t(Ut).on("click","button#save-add-products",Kt),t(Ut).on("click","button#clear-add-products",Rt),t(Ut).on("change","select.discount_type",Zt),t(Ut).on("blur",".wc_input_price",n),t("form#post").on("submit",Xt),t(Ut).css("min-height",t("#coupon_options ul.coupon_data_tabs").height()+10),t(Ut).on("click",".acfw-styled-table .actions .remove",(function(){return Nt(!0)})),t(Ut).on("change","input[name='add_before_cart_condition']",(function(){return Nt(!0)})),function(){var t=Lt(Ut).data("products"),e=Lt(Ut).find(".add-products-data-table tbody");if(t.length>0){var n="";t.forEach((function(t){n+=It(t)})),e.html(n)}else e.html(At(4))}(),t(document).ajaxComplete(te),t(Ut).on("change","select.discount_type",ee)}function Zt(){var t=Lt(this);t.closest("tr").find(".discount_value").prop("disabled","nodiscount"===t.val())}function te(t,e){var n=e.getResponseHeader("X-Subscription-IDs");if(n){var o=Lt(Ut).data("subscription_ids")||[],a=n.split(",").map((function(t){return parseInt(t)}));Lt(Ut).data("subscription_ids",Gt(Gt([],Bt(o),!1),Bt(a),!1).filter((function(t,e,n){return n.indexOf(t)===e})))}}function ee(){var t=Lt(Ut).data("subscription_ids")||[];if(t.length){var e=Lt(this),n=e.closest("tr").find("select.wc-product-search"),o=parseInt(n.val());t.includes(o)&&"nodiscount"!==e.val()&&(vex.dialog.alert(Lt(Ut).data("subscription_discount_error")),e.val("nodiscount"),e.trigger("change"))}}var ne=jQuery;function oe(){var t=ne("#customer_email"),e=parseInt(ne("#usage_limit").val()),n=parseInt(ne("#usage_limit_per_user").val()),o=ne("#acfw_auto_apply_coupon_field"),a=ne("#_acfw_enable_virtual_coupons").is(":checked"),c=ne("#acfw-auto-apply-coupon .auto-apply-warning");(t.val()||e||n||a)&&o.prop("checked")?c.show():c.hide()}var ae=jQuery;function ce(){var t=ae(this),e=t.closest("tr"),n=e.find(".select-shipping-method"),o=e.closest(".acfw-styled-table"),a=(o.data("exclude"),(o.data("zonemethods")||[]).filter((function(e){return e.zone_id==t.val()}))),c=a.length?a[0].methods:[];n.empty(),c.length&&(c.map((function(t){return n.append(new Option(t.label,t.value))})),n.trigger("change"))}var ie=jQuery,le=document.querySelector("#acfw_shipping_overrides");function de(t){ie(le).data("editing",t),ie(le).find("#save-shipping-overrides").prop("disabled",!t)}function re(t){var e=acfw_edit_coupon.no_shipping_overrides_added;return'\n        <tr class="no-result">\n            <td colspan="'.concat(t,'">').concat(e,"</td>\n        </tr>\n    ")}var se=jQuery,ue=document.querySelector("#acfw_shipping_overrides"),pe=woocommerce_admin_meta_boxes.post_id;function fe(){var e=acfw_edit_coupon.post_status,n=ue.querySelector(".acfw-overlay"),o=se(this),a=ue.querySelectorAll(".shipping-overrides-table tbody tr td.object"),c=[];a.forEach((function(t){c.push(se(t).data("object"))})),t(n,"show"),o.prop("disabled",!0),se.post(ajaxurl,{action:"acfw_save_shipping_overrides",coupon_id:pe,overrides:c.length?c:"empty",nonce:se("#acfw_shipping_overrides").data("nonce")},(function(o){"success"==o.status?"publish"!==e&&(se("input[name='post_title']").val()||se("input[name='post_title']").val("coupon-"+pe),se("select[name='post_status']").append(new Option("Published","publish")).val("publish"),se("#publishing-action").append('\n            <input type="hidden" name="publish" value="Publish">\n          '),se("input#publish").click()):(o.error_msg&&vex.dialog.alert(o.error_msg),console.log(o)),se(ue).find("#clear-shipping-overrides").prop("disabled",!1),de(!1),t(n,"hide")}),"json")}function _e(){var e=se(this);if(confirm(e.data("prompt"))){var n=se(ue.querySelector("table.acfw-styled-table")),o=n.find("tbody"),a=ue.querySelector(".acfw-overlay");t(a,"show"),se.post(ajaxurl,{action:"acfw_clear_shipping_overrides",coupon_id:woocommerce_admin_meta_boxes.post_id,_wpnonce:e.data("nonce")},(function(c){if("success"==c.status){var i=n.find("thead tr th").length;o.html(""),o.find("tr").length<=0&&o.append(re(i)),n.data("exclude",[]),e.prop("disabled",!0),de(!1),"Published"!=jQuery("#post-status-display").text()&&(jQuery("input[name='post_title']").val()||jQuery("input[name='post_title']").val("coupon-"+pe),jQuery("input#publish").click())}else c.error_msg&&vex.dialog.alert(c.error_msg),console.log(c);t(a,"hide")}),"json")}}function ve(t){se(ue).data("editing")&&(t.preventDefault(),se(ue).find("#save-shipping-overrides").trigger("click"),se("form#post").off("submit",ve),setTimeout((function(){se("form#post").submit()}),1e3))}var he=jQuery,be=document.querySelector("#acfw_shipping_overrides");function ye(t){void 0===t&&(t={});var n=acfw_edit_coupon.product_table_buttons,c=n.add,l=n.edit,d=n.cancel,r=t.shipping_zone,s=t.discount_type,u=t.discount_value,p=he(be).find(".shipping-overrides-table").data("zonemethods")||[],f=p.map((function(t){return{value:t.zone_id,label:t.zone_name}})),_=u&&i(u)>=0?u:"",v=r>=0||"nozone"===r?l:c,h='\n    <tr class="add-edit-form fresh">\n      <td class="shipping-zone" data-object="'.concat(e(JSON.stringify(t)),'">\n        <div>\n          <select class="select-shipping-zone wc-enhanced-select" data-placeholder="Select shipping zone">\n            ').concat(o(f,r),'\n          </select>\n        </div>\n      </td>\n      <td class="shipping-method">\n        <div>\n          <select class="select-shipping-method wc-enhanced-select" data-placeholder="Select shipping method">\n            ').concat(function(t,e){var n=e.shipping_zone,a=e.shipping_method;if("nozone"===n&&a||n>=0&&a){var c=t.filter((function(t){return t.zone_id==n}));return o(c.length?c[0].methods:[],a)}return o(t.length?t[0].methods:[],a)}(p,t),'\n          </select>\n        </div>\n      </td>\n      <td class="discount">\n        <select class="discount-type">\n          ').concat(function(t){void 0===t&&(t="");var e=acfw_edit_coupon.currency_symbol,n=acfw_edit_coupon.discount_field_options,o=n.override,c=n.percent,i=n.fixed;return'\n    <option value="percent" '.concat(a(t,"percent"),">% : ").concat(c,'</option>\n    <option value="fixed" ').concat(a(t,"fixed"),">-").concat(e," : ").concat(i,'</option>\n    <option value="override" ').concat(a(t,"override"),">").concat(e," : ").concat(o,"</option>\n  ")}(s),'\n        </select>\n        <input type="text" class="discount_value short wc_input_price" value="').concat(_,'">\n      </td>\n      <td class="actions">\n        <button type="button" class="add button-primary">').concat(v,'</button>\n        <button type="button" class="cancel button">').concat(d,"</button>\n      </td>\n    </tr>\n  ");return h}var me=jQuery,ge=document.querySelector("#acfw_shipping_overrides");function we(t){var n=t.shipping_zone,o=t.discount_type,a=t.discount_value,c=t.shipping_method,i=(me(ge).find(".shipping-overrides-table").data("zonemethods")||[]).filter((function(t){return t.zone_id==n}));if(!i.length)return"";var l=i[0],d=l.zone_name,r=l.methods.filter((function(t){return t.value==c}));return r.length?'\n    <tr>\n      <td class="shipping-zone object" data-object="'.concat(e(JSON.stringify(t)),'">\n        ').concat(d,'\n      </td>\n      <td class="shipping-method">\n        ').concat(r[0].label,'\n      </td>\n      <td class="discount">\n        (').concat(o,") ").concat(a,'\n      </td>\n      <td class="actions">\n        <a class="edit" href="javascript:void(0);">\n          <span class="dashicons dashicons-edit"></span>\n        </a>\n        <a class="remove" href="javascript:void(0);">\n          <span class="dashicons dashicons-no"></span>\n        </a>\n      </td>\n    </tr>\n  '):""}var xe=jQuery;function je(){var t=xe(this).closest(".acfw-styled-table"),e=t.find("tbody");t.data("exclude");e.find("tr.no-result").remove(),e.append(ye()),xe("body").trigger("wc-enhanced-select-init"),function(t){var e=t.find(".select-shipping-zone"),n=e.find("option:first");t.removeClass("fresh"),e.val(n.prop("value")),e.trigger("change")}(t.find("tr.add-edit-form.fresh"))}function ke(){var t=acfw_edit_coupon.fill_form_propery_error_msg,e=acfw_edit_coupon.shipping_zone_already_added,n=xe(this).closest("tr"),o=n.closest(".acfw-styled-table"),a=parseInt(n.find(".select-shipping-zone").val()+""),c=n.find(".select-shipping-method").val()+"";a=a>=0&&!isNaN(a)?a:"nozone";var i=o.data("exclude");if(!(a<0)&&c||"nozone"===a&&c)if(i.filter((function(t){return t.zone==a&&t.method==c})).length)vex.dialog.alert(e);else{var l={shipping_zone:a,shipping_method:c,discount_type:n.find(".discount-type").val(),discount_value:n.find(".discount_value").val()};n.replaceWith(we(l)),i.push({zone:a,method:c}),o.data("exclude",i),de(!0)}else vex.dialog.alert(t)}function Se(){var t=jQuery(this),e=t.closest("tr"),n=t.closest(".acfw-styled-table"),o=n.find("tbody"),a=e.find(".shipping-zone").data("object"),c=n.data("exclude")||[];c=c.filter((function(t){return t.zone!=a.shipping_zone||t.method!=a.shipping_method})),o.find("tr.no-result").remove(),e.replaceWith(ye(a)),n.data("exclude",c),xe("body").trigger("wc-enhanced-select-init")}function qe(){var t=jQuery(this),e=t.closest("tr"),n=t.closest("table"),o=e.closest("tbody"),a=e.find("td").length,c=e.find("td.shipping-zone").data("object"),i=n.data("exclude");i=i.filter((function(t){return t.zone!=c.shipping_zone||t.method!=c.shipping_method})),n.data("exclude",i),e.remove(),o.find("tr").length<=0&&o.append(re(a)),de(!0)}function Qe(){var t=acfw_edit_coupon.shipping_zone_already_added,e=jQuery(this),n=e.closest("tr"),o=e.closest("table"),a=n.closest("tbody"),c=n.find("td").length,i=n.find("td.shipping-zone").data("object"),l=i.shipping_zone,d=i.shipping_method,r=o.data("exclude");r.filter((function(t){return t.zone==l&&t.method==d})).length?vex.dialog.alert(t):"nozone"===l&&d||l>=0&&d?(r.push({zone:l,method:l}),n.replaceWith(we(i)),o.data("exclude",r)):(n.remove(),a.find("tr").length<=0&&a.append(re(c)))}var Oe=jQuery,ze=document.querySelector("#acfw_shipping_overrides");function $e(){Oe(ze).on("click",".acfw-styled-table tfoot .add-table-row",je),Oe(ze).on("change","tr.add-edit-form .select-shipping-zone",ce),Oe(ze).on("click","tr.add-edit-form .actions .add",ke),Oe(ze).on("click","tr .actions .edit",Se),Oe(ze).on("click","tr .actions .remove",qe),Oe(ze).on("click","tr.add-edit-form .actions .cancel",Qe),Oe(ze).on("blur",".wc_input_price",n),Oe(ze).on("click","#save-shipping-overrides",fe),Oe(ze).on("click","#clear-shipping-overrides",_e),Oe("form#post").on("submit",ve),Oe(ze).css("min-height",Oe("#coupon_options ul.coupon_data_tabs").height()+10),function(){var t=Oe(ze).find(".shipping-overrides-table"),e=t.find("tbody"),n=t.data("overrides");if(!n.length)return;e.find("tr.no-result").remove(),n.forEach((function(t){e.append(we(t))}))}()}var Ne=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,a,c=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(o=c.next()).done;)i.push(o.value)}catch(t){a={error:t}}finally{try{o&&!o.done&&(n=c.return)&&n.call(c)}finally{if(a)throw a.error}}return i},Ce=function(t,e,n){if(n||2===arguments.length)for(var o,a=0,c=e.length;a<c;a++)!o&&a in e||(o||(o=Array.prototype.slice.call(e,0,a)),o[a]=e[a]);return t.concat(o||Array.prototype.slice.call(e))},Ie=jQuery;function Ae(){var t=document.querySelector("#acfw_scheduler");Ie(t).on("change acfw_load",'.days-time-fields input[type="checkbox"]',Pe),Ie(t).on("change acfw_load",".days-time-fields input.time-field",Ee),Ie(t).on("change",".days-time-fields input.time-field",Te),Ie(t).on("change acfw_load",".acfw-scheduler-section .date-field",De),Ie(t).find('.days-time-fields input[type="checkbox"], .days-time-fields input.time-field').trigger("acfw_load"),Ie(t).find(".acfw-scheduler-section .date-field").trigger("acfw_load"),Ie(".wrap").on("submit","form#post",Je),Ie(".days-time-fields input.time-field").flatpickr({allowInput:!0,enableTime:!0,noCalendar:!0,altInput:!0,altFormat:"h:i K",dateFormat:"H:i",onOpen:function(t,e,n){if(""===e){var o=new Date;o.setHours(0),o.setMinutes(0),n.setDate(o),Ie(".days-time-fields input.time-field").trigger("change")}}})}function Je(t){Ie(".days-time-fields input.time-field").hasClass("error")&&(t.preventDefault(),vex.dialog.alert({unsafeMessage:acfw_edit_coupon.invalid_scheduler_time}),Ie("#publishing-action .spinner").removeClass("is-active"),Ie("#publishing-action #publish").removeClass("disabled"))}function Pe(){var t=Ie(this),e=t.closest(".days-time-field");e.find(".start-time").prop("disabled",!t.is(":checked")||t.is(":disabled")),e.find(".end-time").prop("disabled",!t.is(":checked")||t.is(":disabled"))}function Ee(){var t=Ie(this).closest(".days-time-field"),e=t.find(".start-time"),n=t.find(".end-time"),o=We(n.val())+1,a=We(e.val())-1,c=o?Me(o):"",i=a?Me(a):"";e.attr("max",null!=c?c:""),n.attr("min",null!=i?i:"")}function Te(){var t=Ie(this).closest(".days-time-field"),e=t.find(".start-time"),n=t.find(".end-time"),o=We(e.val()),a=We(n.val());o>=a?e.addClass("error"):e.removeClass("error"),a<=o?n.addClass("error"):n.removeClass("error")}function De(){var t=Ie(this).closest(".options_group"),e=t.find("#_acfw_schedule_start"),n=t.find("#_acfw_schedule_expire"),o=function(t,e){var n=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],o=[];if(!t||!e)return n;for(var a=new Date(t);a<=new Date(e);a.setDate(a.getDate()+1))o.push(n[a.getDay()]);return Ce([],Ne(new Set(o)),!1)}(e.is(":disabled")?"":e.val(),e.is(":disabled")?"":n.val());["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach((function(t){var e=Ie(".".concat(t,"-time-field"));o.includes(t)?e.find('input[type="checkbox"]').prop("disabled",!1).trigger("change"):(e.find('input[type="checkbox"]').prop("disabled",!0),e.find(".time-field").prop("disabled",!0))}))}function We(t){var e=Ne(t.split(":").map((function(t){return parseInt(t)})),2);return 60*e[0]+e[1]}function Me(t){var e=Math.floor(t/60),n=t-60*e;return"".concat(String(e).padStart(2,"0"),":").concat(String(n).padStart(2,"0"))}var Fe=jQuery,He=acfw_edit_coupon.bogo_toggle_editing_mode,Ve=woocommerce_admin_meta_boxes.post_id;function Ke(){var t=Fe(this),e=t.closest("#acfw_bogo_deals").find(".bogo-auto-add-products-field"),n=e.find("input[type='checkbox']");"specific-products"===t.val()?(n.prop("disabled",!1),e.addClass("show")):(n.prop("disabled",!1),e.removeClass("show"))}function Re(){var t=Fe(this),e=t.find("select#bogo-deals-type"),n=t.find(".bogo-auto-add-products-field input[type='checkbox']");"specific-products"===e.val()&&Fe.post(ajaxurl,{action:"acfw_save_bogo_additional_settings",coupon_id:Ve,auto_add_products:n.is(":checked")?"yes":"no",nonce:Fe(".bogo-settings-field").data("nonce")})}function Xe(){var t=Fe("#acfw_bogo_deals"),e=t.find("input[name='bogo_type'][value='once']"),n=t.find("input[name='bogo_type'][value='repeat']"),o=t.find("#bogo-condition-type").val(),a=t.find("#bogo-deals-type").val();t.find(".repeat-incompatible").remove(),"any-products"===a&&"any-products"!==o?(e.prop("checked",!0),n.prop("disabled",!0),n.closest(".radio-group-wrap").append('<span class="repeat-incompatible">'.concat(acfw_edit_coupon.repeat_incompatible_notice,"</span>"))):n.prop("disabled",!1)}var Be=document.querySelector(".acfw-sort-coupon-priority-field"),Ge=jQuery;function Le(){var t=Ge(this),e=Ge(Be).find("input#_acfw_coupon_sort_priority"),n=t.val().toString();switch(n){case"0":case"1":case"10":case"30":case"50":case"90":e.hide(),e.val(n);break;default:e.show(),e.val(Ge(Be).data("value"))}}function Ue(){var t=Ge(this),e=parseInt(t.val());(isNaN(e)||1>e)&&(vex.dialog.alert(acfw_edit_coupon.coupon_sort_invalid),t.val(""))}var Ye=jQuery;function Ze(t){var e=jQuery(this),n=e.closest(".inside"),o=Ye("select.acfw-allowed-customers");"change"===t.type&&n.find(".save-notice").show(),e.is(":checked")?(n.removeClass("disabled"),o.prop("disabled",!0),o.closest(".options_group").hide(),tn(!0)):(n.addClass("disabled"),o.closest(".options_group").show(),o.prop("disabled",!1),tn(!1))}function tn(t){var e,n=jQuery(".form-field._acfw_coupon_url_field"),o=jQuery(".form-field._acfw_code_url_override_field");if(t){var a=null!==(e=Ye("#acfw-virtual-coupon .feature-control").data("labels"))&&void 0!==e?e:{};n.find("input,button,span").hide(),n.append('<span class="vc-manage-url-coupon">'.concat(a.url_coupon_message,"</span>")),o.hide()}else n.find(".vc-manage-url-coupon").remove(),n.find("input,button,span").show(),o.show()}jQuery;var en=jQuery;function nn(){var t=en(this),e=t.closest(".woocommerce_options_panel").find("._acfw_percentage_discount_cap_field");"percent"===t.val()||"acfw_percentage_cashback"===t.val()?(e.addClass("show"),e.find("input").prop("disabled",!1)):(e.removeClass("show"),e.find("input").prop("disabled",!0))}function on(){en("#_acfw_coupon_label").prop("disabled",!1)}var an=jQuery;function cn(){var t=an(this),e=an("p.coupon_amount_field label"),n=acfw_edit_coupon.cashback_coupon,o=e.data("default_label");switch(o||(e.data("default_label",e.text()),o=e.text()),t.val()){case"acfw_percentage_cashback":e.text(n.cashback_percentage_label);break;case"acfw_fixed_cashback":e.text(n.cashback_amount_label);break;default:e.text(o)}}function ln(){var t=an(this),e=an("#_acfw_cashback_waiting_period");switch(t.val()){case"acfw_percentage_cashback":case"acfw_fixed_cashback":e.closest("p.form-field").show(),e.prop("disabled",!1);break;default:e.closest("p.form-field").hide(),e.prop("disabled",!0)}}var dn=acfw_edit_coupon.modules;jQuery(document).ready((function(t){var e,n;dn.indexOf("acfw_cart_conditions_module")>-1&&qt(),dn.indexOf("acfw_add_free_products_module")>-1&&Yt(),dn.indexOf("acfw_auto_apply_module")>-1&&(ne("body").on("change","#customer_email,#acfw_auto_apply_coupon_field,#usage_limit,#usage_limit_per_user,#_acfw_enable_virtual_coupons",oe),ne("#customer_email,#acfw_auto_apply_coupon_field").trigger("change")),dn.indexOf("acfw_shipping_overrides_module")>-1&&$e(),dn.indexOf("acfw_scheduler_module")>-1&&Ae(),dn.indexOf("acfw_bogo_deals_module")>-1&&function(){var t=document.querySelector("#acfw_bogo_deals");Fe(t).on("change acfw_load","select#bogo-deals-type",Ke),Fe(t).on("change acfw_load","select#bogo-condition-type,select#bogo-deals-type",Xe),Fe(t).on("change acfw_load",".bogo-auto-add-products-field input[type='checkbox']",(function(){return He(!0)})),Fe(t).on("save_bogo_deals",Re),Fe(t).find("select#bogo-deals-type").trigger("acfw_load")}(),dn.indexOf("acfw_sort_coupons_module")>-1&&(Ge(Be).on("change","select#_acfw_coupon_sort_select",Le),Ge(Be).on("change","input#_acfw_coupon_sort_priority",Ue),Ge(Be).find("select#_acfw_coupon_sort_select").trigger("change")),dn.indexOf("acfw_virtual_coupons_module")>-1&&(Ye("body").on("change load_virtual_coupon","#_acfw_enable_virtual_coupons",Ze),Ye("#_acfw_enable_virtual_coupons").trigger("load_virtual_coupon")),e=jQuery("p.acfw_exclude_coupons_field"),n=e.closest(".options_group"),e.insertAfter("p.form-field.individual_use_field"),n.remove(),en("#woocommerce-coupon-data").on("change acfwp_load","#discount_type",nn),en("#woocommerce-coupon-data").on("change acfw_load","select#discount_type",on),en("#discount_type").trigger("acfwp_load"),en("#_acfw_coupon_label").trigger("acfw_load"),an("#general_coupon_data").on("change acfw_load","#discount_type",cn),an("#general_coupon_data").on("change acfw_load","#discount_type",ln),an("#discount_type").trigger("acfw_load")}))}();
//# sourceMappingURL=acfwp-edit-advanced-coupon.js.map