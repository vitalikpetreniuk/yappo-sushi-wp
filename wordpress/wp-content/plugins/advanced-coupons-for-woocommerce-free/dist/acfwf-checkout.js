!function(){"use strict";jQuery((function(e){var o={initPopover:function(){e("#acfw-apply-store-credits-discount").webuiPopover({placement:"bottom-left",trigger:"click",url:"#acfw-store-credits-redeem-form",width:250,closable:!0,animation:"pop",padding:!1,onShow:function(e){e.find(".input-text").focus()}})},redeemStoreCredits:function(){var c=e(this),t=c.siblings("input.input-text"),r=c.closest("#acfw-store-credits-redeem-form"),i=o.parsePrice(t.val());r.find("p.invalid-message").remove(),e(".woocommerce-NoticeGroup-updateOrderReview").remove(),o.validatePrice(i)?(WebuiPopovers.hideAll(),o.blockCheckout(),e.post(wc_checkout_params.ajax_url,{action:"acfwf_redeem_store_credits",amount:i,wpnonce:acfwfCheckout.redeem_nonce},(function(c){o.unblockCheckout(),t.val(""),e(document.body).trigger("update_checkout",{update_shipping_method:!1})}))):r.append("<p class='invalid-message'>"+acfwfCheckout.enter_valid_price+"</p>")},validatePrice:function(e){e=e.toString();var o=new RegExp("[^-0-9%\\.]+","gi"),c=new RegExp('[^\\.}"]',"gi"),t=e.replace(o,"");return 1<t.replace(c,"").length&&(t=t.replace(c,"")),parseFloat(e)===parseFloat(t)},parsePrice:function(e){return e?parseFloat(e.replace(acfwfCheckout.thousand_separator,"").replace(acfwfCheckout.decimal_separator,".")):0},blockCheckout:function(){e(".woocommerce form.woocommerce-checkout").addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblockCheckout:function(){e(".woocommerce-error, .woocommerce-message").remove(),e(".woocommerce form.woocommerce-checkout").removeClass("processing").unblock()},reapplyDiscountViaNotice:function(o){o.stopPropagation(),WebuiPopovers.show("#acfw-apply-store-credits-discount"),e("html, body").animate({scrollTop:e(".webui-popover.in").offset().top-200},1e3)},init:function(){e(document.body).on("updated_checkout",this.initPopover),e(document.body).on("click","#acfw-store-credits-redeem-form .button",this.redeemStoreCredits),e(document.body).on("click",".woocommerce .acfw-reapply-sc-discount",this.reapplyDiscountViaNotice)}};o.init()}))}();
//# sourceMappingURL=acfwf-checkout.js.map